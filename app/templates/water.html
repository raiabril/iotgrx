{% extends "base.html" %}

{% block content %}
<div class="row">
    <div class="col-md-6">
      <div class="chart-container content-section">
        <h2>My devices</h2>
        {% if devices.__len__() == 0%}
            <p>No se han recuperado devices para el usuario.</p>
        {% else %}
        <table style="width:100%">
          <tr>
              <th>DeviceID</th>
              <th>Name</th>
              <th>Date</th>
              <th>Time</th>
          </tr>
          {% for device in devices %}
          <tr>
            <td>{{device.id}}</td>
            <td>{{device.name}}</td>
            <td>{{device.date_created.strftime('%d/%m/%Y')}}</td>
            <td>{{device.date_created.strftime('%H:%M')}}</td>
            <td>
              <form method="POST" action="">
                {{ form.hidden_tag() }}
                <div class="form-group">
                    {{form.submit(class="btn btn-outline-info")}}
                </div>
              </form>
            </td>
          </tr>
          {% endfor %}
        </table>
        {% endif %}
        
      </div>
    </div>
    <div class="col-md-6">
      <div class="chart-container content-section">
        <h2>Active requests</h2>
        {% if requests.__len__() == 0%}
            <p>No se han recuperado requests para el usuario.</p>
        {% else %}
        <table style="width:100%">
          <tr>
              <th>Device</th>
              <th>Date</th>
              <th>Time</th>
              <th>Duration [ms]</th>
          </tr>
          {% for request in requests %}
          <tr>
            <td>{{request.device.name}}</td>
            <td>{{request.date_created.strftime('%d/%m/%Y')}}</td>
            <td>{{request.date_created.strftime('%H:%M')}}</td>
            <td>{{request.duration}}</td>
          </tr>
          {% endfor %}
        </table>
        {% endif %}
        <hr>
        <h2>Last logs</h2>
        {% if logs.__len__() == 0%}
            <p>No se han recuperado requests para el usuario.</p>
        {% else %}

        <table style="width:100%">
          <tr>
              <th>Device</th>
              <th>Date</th>
              <th>Time</th>
              <th>Duration [ms]</th>
          </tr>
          {% for log in logs %}
          <tr>
              <td>{{log.device.name}}</td>
              <td>{{log.date_created.strftime('%d/%m/%Y')}}</td>
              <td>{{log.date_created.strftime('%H:%M')}}</td>
              <td>{{log.duration}}</td>
          </tr>
          {% endfor %}
        </table>
        {% endif %}
        <hr>
        <h2>Last events</h2>
        {% if events.__len__() == 0%}
            <p>No recent data.</p>
        {% else %}
        <table style="width:100%">
          <tr>
              <th>Date</th>
              <th>Time</th>
              <th>DeviceID</th>
              <th>SensorID</th>
              <th>Value</th>
          </tr>
          {% for event in events %}
          <tr>
            <td>{{event.date_created.strftime('%d/%m/%Y')}}</td>
            <td>{{event.date_created.strftime('%H:%M')}}</td>
            <td>{{event.sensor.device.name}}</td>
            <td>{{event.sensor.name}}</td>
            <td>{{event.value}}</td>
          </tr>
          {% endfor %}
        </table>
        {% endif %}
      </div>
    </div>
  </div>
{% endblock %}